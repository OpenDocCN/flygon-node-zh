["```js\nvar users = {};\n\nfunction getUser(id, next) {\n  if (users.hasOwnProperty(id)) {\n    return next(null, users[id]);\n  }\n\n  userdb.findOne({ id: id }, function (err, user) {\n    if (err) return next(err);\n\n    users[id] = user;\n    return next(null, user);\n  });\n}\n```", "```js\nvar users = {};\n\nfunction getUser(id, next) {\n  if (users.hasOwnProperty(id)) {\n    if (users[id].hasOwnProperty(\"data\")) {\n      // already have a value\n      return next(null, users[id].data);\n    }\n    // not yet, queue the callback\n    return users[id].queue.push(next);\n  }\n\n  // first time\n  users[id] = {\n    queue: [ next ]\n  };\n\n  userdb.findOne({ id: id }, function (err, user) {\n    if (err) return next(err);\n\n    users[id].data = user;\n\n    users[id].queue.map(function (cb) {\n      cb(null, user);\n    });\n\n    delete users[id].queue;\n  });\n}\n```"]